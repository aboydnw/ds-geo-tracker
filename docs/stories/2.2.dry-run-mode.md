# Story 2.2: Dry-Run Mode

## Status
Draft

## Story
**As a** developer,  
**I want** a dry-run mode that logs what would be sent without calling Plausible,  
**so that** I can test the tracker safely.

## Acceptance Criteria
1. `DRY_RUN=true` environment variable enables dry-run mode
2. In dry-run mode, `sendEventToPlausible` logs payload but doesn't make HTTP request
3. Logs clearly indicate "[DRY-RUN]" prefix when in this mode
4. Summary shows "X events would be sent" instead of "X events sent"
5. Dry-run mode can be triggered in GitHub Actions via workflow input parameter

## Tasks / Subtasks
- [ ] Add DRY_RUN check to plausible.js (AC: 1, 2)
  - [ ] Check `process.env.DRY_RUN === 'true'` at function start
  - [ ] If dry-run, log payload and return true without HTTP call
- [ ] Update logging for dry-run mode (AC: 3)
  - [ ] Add "[DRY-RUN]" prefix to all dry-run logs
  - [ ] Log full payload that would be sent
- [ ] Update summary messaging (AC: 4)
  - [ ] Track dry-run state in main script
  - [ ] Change summary text based on mode
- [ ] Add GitHub Actions workflow input (AC: 5)
  - [ ] Add `workflow_dispatch` input for dry_run boolean
  - [ ] Pass as environment variable to job
- [ ] Update .env.example with DRY_RUN documentation

## Dev Notes
**Environment Variable:**
- `DRY_RUN=true` - Enable dry-run mode
- Any other value or unset = normal mode

**Dry-Run Log Format:**
```
[DRY-RUN] Would send event: GEO_Query_Tracked
[DRY-RUN] Payload: {
  "name": "GEO_Query_Tracked",
  "url": "https://developmentseed.org/",
  "domain": "developmentseed.org",
  "props": { ... }
}
```

**Summary Format:**
- Normal: "Completed: 10 events sent (10 successful, 0 failed)"
- Dry-run: "Completed: 10 events would be sent (dry-run mode)"

**GitHub Actions Input:**
```yaml
on:
  workflow_dispatch:
    inputs:
      dry_run:
        description: 'Run in dry-run mode (no events sent)'
        required: false
        default: 'false'
        type: boolean
```

### Testing
- Set `DRY_RUN=true` in .env, run script
- Verify "[DRY-RUN]" appears in logs
- Verify no events appear in Plausible dashboard
- Verify summary says "would be sent"
- Test GitHub Actions with dry_run input checked

## Change Log
| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2026-02-05 | 0.1 | Initial story created | PO Agent |
